---
# required metadata

title: Compress large documents that are generated in Electronic re porting
description: This topic explains how to compress large documents that are generated by an Electronic reporting (ER) format.
author: NickSelin
manager: kfend
ms.date: 09/11/2020
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 

# optional metadata

ms.search.form: EROperationDesigner, ERFormatDestinationTable
# ROBOTS: 
audience: Application User, IT Pro
# ms.devlang: 
ms.reviewer: kfend
ms.search.scope: Core, Operations
# ms.tgt_pltfrm: 
ms.custom: 58771
ms.assetid: 
ms.search.region: Global
# ms.search.industry: 
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: AX 10.0.9

---

# Compressing large documents that are generated in Electronic reporting 

[!include [banner](../includes/banner.md)]

You may use the [Electronic reporting (ER) framework](general-electronic-reporting.md) to configure a solution for fetching transactional data to generate an outbound document which may be quite large. When this type of document is generated, the [AOS](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/dev-tools/access-instances#location-of-packages-source-code-and-other-aos-configurations) memory is used to keep it and at some point, it must be downloaded from your Dynamics 365 Finance application. Currently, the maximum size of a single document that is generated in Electronic reporting (ER) is limited to 2GB. Finance currently also has a 1GB [limitation](https://fix.lcs.dynamics.com/Issue/Details?bugId=489291) for the maximum size of a downloaded file. This means you need to configure an ER solution
that reduces the probability of exceeding these limitations and receiving the exceptions, **Stream was too long** or **Overflow or underflow in the arithmetic operation**.

When you configura a solution, you can adjust your ER format in the **Operations** designer by adding a new root element of the **Folder** type to compress the content that is generated by any nested element of it. Compression works just-in-time allowing a reduction in peak memory usage and the size of the file that will be downloaded.

> [!NOTE]
> File compression takes an additional percentage of CPU usage.

For more information about this approach, complete the examples in this topic.

## Example: Compress an outbound document

This example shows how a user assigned to the **System administrator** or **Electronic reporting functional consultant** role can configure an ER format to compress a generated document.

### Prerequisites
Before you complete the procedures in this topic, the following steps must be completed.

1.  [Activate a configuration provider](er-defer-xml-element.md#activate-a-configuration-provider).
2.  [Import the sample ER configurations](er-defer-xml-element.md#import-the-sample-er-configurations).
3.  [Review the imported format](er-defer-xml-element.md#review-the-imported-format).  
    
> [!NOTE]
> Currently, the format structure starts from the **Report** element of the **File** type and contains XML elements. This means that an outbound document will be generated in XML format with no compression usage.

### Generate an ER format to get an uncompressed document

1.  [Run the imported format](er-defer-xml-element.md#run-the-imported-format).  
    
    The generated document in XML format is 3KB large.

    ![Preview of non-compressed outbound document](./media/er-compress-outbound-files1.png)

### Modify the format to compress generated output

1.  Go to **Modules** \> **Organization administration** \> **Electronic reporting** \> **Configurations**.
2.  On the **Configurations** page, in the configuration tree, expand **Model to learn deferred elements**.
3.  Select the **Format to learn deferred XML elements** configuration.
4.  Select **Designer** to modify the format structure.
5.  On the **Format designer** page, on the **Format** tab, select **Add root** to insert a new root format element.
6.  In the **Add** pop up page, select **Common\\Folder**.
7.  Select **OK** to confirm a new root element entry.
8.  Select **Save**.
    
    > [!NOTE]
    > The format structure starts from the **Folder** type element. This element will generate an output as a compressed (zipped) file. Respectively, when a generated by the **Report** element document will be placed to an outbound zipped file, its content will be compressed reducing the size of an outbound file.

### Generate an ER format to get a compressed document

1.  On the **Format designer** page, select **Run**.
2.  Download the file that the web browser offers, and open it for review.

    > [!NOTE] 
    > The generated document in ZIP format is 1KB. The compression of the XML file this ZIP file holds is 87%. The compression ratio very much depends on the data being compressed.

    ![Preview of compressed outbound document](./media/er-compress-outbound-files2.png)

> [!NOTE]
> If the ER [destination](electronic-reporting-destinations.md) is configured for the format element that generates an output (**Report** element in the sample above), the output compression will be bypassed.

## Additional resources

[Electronic reporting (ER) overview](general-electronic-reporting.md)

[Electronic reporting (ER) destinations](electronic-reporting-destinations.md)

[Defer the execution of XML elements in ER formats](er-defer-xml-element.md)
